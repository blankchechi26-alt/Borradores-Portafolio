# -*- coding: utf-8 -*-
"""Analisis portafolio 5.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1QbE3qqurj9Ih2uEIxucmdTRFTn7zgUmM
"""

# -*- coding: utf-8 -*-
"""Aplicaci贸n de an谩lisis de portafolio con dos acciones (Streamlit y Yahoo Finance)"""

import streamlit as st
import pandas as pd
import yfinance as yf
import matplotlib.pyplot as plt

# -------------------------------
# T铆tulo e introducci贸n
# -------------------------------
st.title('ANLISIS DE PORTAFOLIO DE INVERSIN')
st.subheader('Ejemplo pr谩ctico de diversificaci贸n con dos acciones')

st.markdown("""
Este ejemplo muestra c贸mo la **diversificaci贸n** reduce el riesgo al combinar activos de distintos sectores.
Usaremos las acciones de **Apple (AAPL)** y **Coca-Cola (KO)**.
""")

# -------------------------------
# Selecci贸n de acciones
# -------------------------------
tickers = ['AAPL', 'KO']
st.write("**Acciones seleccionadas:**", tickers)

# -------------------------------
# Descarga de datos desde Yahoo Finance
# -------------------------------
# Removed the try...except block to allow the error to propagate if yf.download fails.
data = yf.download(tickers, start='2022-01-01', end='2025-01-01')
st.subheader(" Precios hist贸ricos ajustados")
st.dataframe(data.tail())


# -------------------------------
# C谩lculo de rendimientos
# -------------------------------
# Select the 'Close' price from the MultiIndex data
close_prices = data['Close']
returns = close_prices.pct_change().dropna()

st.subheader(" Estad铆sticas de rentabilidad diaria")
st.write(returns.describe())

# -------------------------------
# Gr谩fico de evoluci贸n de precios
# -------------------------------
st.subheader(" Evoluci贸n del precio de las acciones")
fig, ax = plt.subplots()
close_prices.plot(ax=ax)
ax.set_xlabel("Fecha")
ax.set_ylabel("Precio ajustado (USD)")
st.pyplot(fig)

# -------------------------------
# Gr谩fico de dispersi贸n (correlaci贸n)
# -------------------------------
st.subheader(" Relaci贸n entre los rendimientos (correlaci贸n)")
fig2, ax2 = plt.subplots()
ax2.scatter(returns['AAPL'], returns['KO'], alpha=0.6)
ax2.set_xlabel('Rendimiento diario de Apple (AAPL)')
ax2.set_ylabel('Rendimiento diario de Coca-Cola (KO)')
ax2.set_title('Diversificaci贸n entre Apple y Coca-Cola')
st.pyplot(fig2)

# -------------------------------
# Matriz de correlaci贸n
# -------------------------------
st.subheader(" Matriz de correlaci贸n")
correlacion = returns.corr()
st.write(correlacion)

# -------------------------------
# Interpretaci贸n
# -------------------------------
st.markdown("""
###  Interpretaci贸n
- Si la **correlaci贸n** entre AAPL y KO es **baja o negativa**, significa que las acciones no se mueven igual:
  cuando una baja, la otra puede subir o mantenerse estable.
- Esto **reduce el riesgo total del portafolio** y demuestra la utilidad de la **diversificaci贸n**.

**Conclusi贸n:** combinar activos de sectores distintos (tecnolog铆a y consumo) genera un portafolio m谩s estable frente a la volatilidad del mercado.
""")

!streamlit run app.py

# Commented out IPython magic to ensure Python compatibility.
# %pip install streamlit yfinance matplotlib pandas

!pip install yfinance

